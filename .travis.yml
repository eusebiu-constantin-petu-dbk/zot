language: go

go:
  - 1.14.x

env:
  - GO111MODULE=on

matrix:
  include:
    - os: linux

notifications:
  email: false

install:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then go get -u github.com/swaggo/swag/cmd/swag; go mod download; sudo apt-get update; sudo apt-get install rpm; sudo apt install snapd; sudo snap install skopeo --edge --devmode; fi

script:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then travis_wait 60 make; fi

deploy:
  skip_cleanup: true
  provider: releases
  api_key:
    secure: "DlCyRM85KiUN6p9BvmBjf7gtSHfjbuiJhjIOP19drQfIwxDNvgdQXOV8zSOIS2g8bQK8LOUkUWbVlxRkA5RBVfNb1v8MUaRhByOJ8zl8JMSLs4XcUvcLFENp7Au/6HCWMrPg170f3NvoaJFBCyVFh8nYRys7PcRenRafnvEapTLA6gNMaS6T4PIenwwu/FFfE+jAmW3PHDx+Ln0sgmTpyV+/8MyJrS0X39HUeM9HgX5C0ErUMptlb4LIrN5feGeHSE9agOKT7yIGoa4UzXpm0WaYIhg291S417l8uCS8uCa4j2D7EUJJmYTKi7I56hCJmMqBWttHrQhSRLfe6PKiBEw+ieR8lhcv/B5MMuWO04oypRko1/iDub8rYclzcty7WMqWDp+Fl0wT7SIy9fHL9kE8moIItTQDVxRUV3YaLx2pxD4o8OHea8FFnH/I6AMZkikw0Gk1bZlUmYsH0vFghs45rY71tMoVLgk9WAqeIbcgTgq1XEtdokY+PbnZ01EdlQKLj4LA8Wf1KfCqId4EDycgSF/3TAcWiuPr7cJFV9zgyOI4dzr1lRkLJi9huK4MmTbA5NYsA6Ci/Ca1+1hAUfDwcbSjRTeM4s4sCQnxihzQo66Ba0F18kFGVadkrnh/g1DnsW6NeTyfuukU4JvDg4/4Cyqa0IoG2rdERWgo4Es="
  file_glob: true
  file: bin/zot*
  on:
    tags: true

after_success:
  - bash <(curl -s https://codecov.io/bash)

